<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Configuration Reference â€” Deployer Documentation</title>
  <link rel="icon" type="image/x-icon" href="references/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link rel="stylesheet" href="css/docs_styles.css" />
</head>

<body>

  <div class="layout">
    <aside id="nav-placeholder"></aside>

    <main class="p-4">
      <h1 class="mb-3">
        <i class="fa-solid fa-gear me-2"></i> Configuration Reference
      </h1>

      <p class="text-muted mb-4">
        Complete reference for all configuration files used by the Digital Twin Deployer.
      </p>

      <!-- Main Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-file-code me-2"></i>config.json</h2>
        <p><strong>Purpose:</strong> Main digital twin configuration parameters.</p>
        <p><strong>Location:</strong> <code>./config.json</code></p>

        <h4 class="mt-3">Schema</h4>
        <pre class="p-3 rounded"><code>{
  "digital_twin_name": "string",
  "hot_storage_size_in_days": number,
  "cold_storage_size_in_days": number,
  "mode": "string"
}</code></pre>

        <h4 class="mt-3">Fields</h4>
        <table class="t2c-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="mono">digital_twin_name</td>
              <td>string</td>
              <td>Prefix for all cloud resources. Used as namespace identifier.</td>
            </tr>
            <tr>
              <td class="mono">hot_storage_size_in_days</td>
              <td>number</td>
              <td>Number of days data remains in hot storage before moving to cold</td>
            </tr>
            <tr>
              <td class="mono">cold_storage_size_in_days</td>
              <td>number</td>
              <td>Number of days data remains in cold storage before moving to archive</td>
            </tr>
            <tr>
              <td class="mono">mode</td>
              <td>string</td>
              <td>Deployment mode: "DEBUG" or "PRODUCTION"</td>
            </tr>
          </tbody>
        </table>

        <h4 class="mt-3">Example</h4>
        <pre class="p-3 rounded"><code>{
  "digital_twin_name": "my-dt",
  "hot_storage_size_in_days": 30,
  "cold_storage_size_in_days": 90,
  "mode": "DEBUG"
}</code></pre>
      </div>

      <!-- Credentials Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-key me-2"></i>config_credentials.json</h2>
        <p><strong>Purpose:</strong> Cloud provider authentication credentials.</p>
        <p><strong>Location:</strong> <code>./config_credentials.json</code></p>

        <div class="callout warn">
          <strong><i class="fa-solid fa-exclamation-triangle me-2"></i>Security Warning</strong>
          This file contains sensitive credentials. Never commit to version control! It's in
          <code>.gitignore</code>.
        </div>

        <h4 class="mt-3">AWS Credentials</h4>
        <pre class="p-3 rounded"><code>{
  "aws": {
    "aws_access_key_id": "AKIAIOSFODNN7EXAMPLE",
    "aws_secret_access_key": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",
    "aws_region": "eu-central-1"
  }
}</code></pre>

        <h4 class="mt-3">Azure Credentials (Planned)</h4>
        <pre class="p-3 rounded"><code>{
  "azure": {
    "azure_subscription_id": "00000000-0000-0000-0000-000000000000",
    "azure_client_id": "00000000-0000-0000-0000-000000000000",
    "azure_client_secret": "your-client-secret",
    "azure_tenant_id": "00000000-0000-0000-0000-000000000000",
    "azure_region": "westeurope"
  }
}</code></pre>

        <h4 class="mt-3">GCP Credentials (Planned)</h4>
        <pre class="p-3 rounded"><code>{
  "gcp": {
    "gcp_project_id": "your-project-id",
    "gcp_credentials_file": "/path/to/service-account.json",
    "gcp_region": "europe-west1"
  }
}</code></pre>
      </div>

      <!-- Inter-Cloud Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-network-wired me-2"></i>config_inter_cloud.json</h2>
        <p><strong>Purpose:</strong> Cross-cloud connection configuration for multi-cloud deployments.</p>
        <p><strong>Location:</strong> <code>./config_inter_cloud.json</code></p>

        <div class="callout info">
          <strong><i class="fa-solid fa-info-circle me-2"></i>Optional File</strong>
          This file is only required when deploying across multiple cloud providers.
        </div>

        <h4 class="mt-3">Schema</h4>
        <pre class="p-3 rounded"><code>{
  "connections": {
    "{source}_l1_to_{target}_l2": {
      "url": "string",
      "token": "string"
    }
  }
}</code></pre>

        <h4 class="mt-3">Fields</h4>
        <table class="t2c-table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="mono">connections</td>
              <td>object</td>
              <td>Map of connection identifiers to connection details</td>
            </tr>
            <tr>
              <td class="mono">url</td>
              <td>string</td>
              <td>Remote ingestion endpoint URL</td>
            </tr>
            <tr>
              <td class="mono">token</td>
              <td>string</td>
              <td>Authentication token for the remote endpoint</td>
            </tr>
          </tbody>
        </table>

        <h4 class="mt-3">Example</h4>
        <pre class="p-3 rounded"><code>{
  "connections": {
    "aws_l1_to_azure_l2": {
      "url": "https://my-azure-function.azurewebsites.net/api/ingest",
      "token": "your-secret-token"
    }
  }
}</code></pre>
      </div>

      <!-- IoT Devices Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-microchip me-2"></i>config_iot_devices.json</h2>
        <p><strong>Purpose:</strong> Define IoT devices and their properties.</p>
        <p><strong>Location:</strong> <code>./config_iot_devices.json</code></p>

        <h4 class="mt-3">Schema</h4>
        <pre class="p-3 rounded"><code>[
  {
    "id": "string",
    "properties": [
      {
        "name": "string",
        "dataType": "STRING | DOUBLE | INTEGER | BOOLEAN",
        "initValue": any  // optional
      }
    ]
  }
]</code></pre>

        <h4 class="mt-3">Example</h4>
        <pre class="p-3 rounded"><code>[
  {
    "id": "temperature-sensor-1",
    "properties": [
      { "name": "temperature", "dataType": "DOUBLE" }
    ]
  },
  {
    "id": "temperature-sensor-1-const",
    "properties": [
      { "name": "serial-number", "dataType": "STRING", "initValue": "temp-sens-143323" },
      { "name": "maxTemperature", "dataType": "DOUBLE", "initValue": 60.0 }
    ]
  },
  {
    "id": "pressure-sensor-1",
    "properties": [
      { "name": "pressure", "dataType": "DOUBLE" },
      { "name": "density", "dataType": "DOUBLE" },
      { "name": "hardness", "dataType": "DOUBLE" }
    ]
  }
]</code></pre>

        <p class="mt-2"><strong>Notes:</strong></p>
        <ul>
          <li>Each device gets its own processor Lambda function deployed</li>
          <li>Devices with <code>initValue</code> properties are treated as constant/static properties</li>
          <li>Device IDs must be unique within the digital twin</li>
        </ul>
      </div>

      <!-- Providers Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-cloud me-2"></i>config_providers.json</h2>
        <p><strong>Purpose:</strong> Map each layer to a cloud provider.</p>
        <p><strong>Location:</strong> <code>./config_providers.json</code></p>

        <h4 class="mt-3">Schema</h4>
        <pre class="p-3 rounded"><code>{
  "layer_1_provider": "aws" | "azure" | "google",
  "layer_2_provider": "aws" | "azure" | "google",
  "layer_3_hot_provider": "aws" | "azure" | "google",
  "layer_3_cool_provider": "aws" | "azure" | "google",
  "layer_3_archive_provider": "aws" | "azure" | "google",
  "layer_4_provider": "aws" | "azure" | "google",
  "layer_5_provider": "aws" | "azure" | "google"
}</code></pre>

        <h4 class="mt-3">Example: All AWS</h4>
        <pre class="p-3 rounded"><code>{
  "layer_1_provider": "aws",
  "layer_2_provider": "aws",
  "layer_3_hot_provider": "aws",
  "layer_3_cool_provider": "aws",
  "layer_3_archive_provider": "aws",
  "layer_4_provider": "aws",
  "layer_5_provider": "aws"
}</code></pre>

        <h4 class="mt-3">Example: Multi-Cloud (Future)</h4>
        <pre class="p-3 rounded"><code>{
  "layer_1_provider": "gcp",
  "layer_2_provider": "gcp",
  "layer_3_hot_provider": "aws",
  "layer_3_cool_provider": "gcp",
  "layer_3_archive_provider": "azure",
  "layer_4_provider": "aws",
  "layer_5_provider": "azure"
}</code></pre>

        <div class="callout info">
          <strong><i class="fa-solid fa-info-circle me-2"></i>Note</strong>
          Currently only AWS is fully implemented. Azure and GCP providers are in development.
        </div>
      </div>

      <!-- Hierarchy Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-sitemap me-2"></i>config_hierarchy.json</h2>
        <p><strong>Purpose:</strong> Define the TwinMaker entity hierarchy (rooms, machines, components).</p>
        <p><strong>Location:</strong> <code>./config_hierarchy.json</code></p>

        <h4 class="mt-3">Schema</h4>
        <pre class="p-3 rounded"><code>[
  {
    "type": "entity" | "component",
    "id": "string",           // for entities
    "name": "string",         // for components
    "componentTypeId": "string",  // optional
    "iotDeviceId": "string",      // optional
    "children": [ ... ]       // nested entities/components
  }
]</code></pre>

        <h4 class="mt-3">Example</h4>
        <pre class="p-3 rounded"><code>[
  {
    "type": "entity",
    "id": "room-1",
    "children": [
      {
        "type": "entity",
        "id": "machine-1",
        "children": [
          {
            "type": "component",
            "name": "temperature-sensor-1",
            "componentTypeId": "dt-temperature-sensor-1"
          },
          {
            "type": "component",
            "name": "temperature-sensor-1-const",
            "iotDeviceId": "temperature-sensor-1-const"
          }
        ]
      },
      {
        "type": "component",
        "name": "temperature-sensor-2",
        "iotDeviceId": "temperature-sensor-2"
      }
    ]
  },
  {
    "type": "entity",
    "id": "room-2",
    "children": [
      {
        "type": "component",
        "name": "pressure-sensor-1",
        "iotDeviceId": "pressure-sensor-1"
      }
    ]
  }
]</code></pre>

        <p class="mt-2"><strong>Notes:</strong></p>
        <ul>
          <li>Hierarchy is deployed to AWS IoT TwinMaker</li>
          <li>Components reference IoT devices defined in <code>config_iot_devices.json</code></li>
          <li>Supports arbitrary nesting depth</li>
        </ul>
      </div>

      <!-- Events Config -->
      <div class="card mb-4">
        <h2 class="mb-3"><i class="fa-solid fa-bolt me-2"></i>config_events.json</h2>
        <p><strong>Purpose:</strong> Define event conditions and automated actions.</p>
        <p><strong>Location:</strong> <code>./config_events.json</code></p>

        <h4 class="mt-3">Schema</h4>
        <pre class="p-3 rounded"><code>[
  {
    "condition": "string",  // TwinMaker query expression
    "action": {
      "type": "lambda",
      "functionName": "string",
      "pathToCode": "string",  // optional
      "autoDeploy": boolean,
      "feedback": {
        "type": "mqtt",
        "topic": "string",        // or
        "iotDeviceId": "string",  // alternative
        "payload": object | "action-result"
      }
    }
  }
]</code></pre>

        <h4 class="mt-3">Example</h4>
        <pre class="p-3 rounded"><code>[
  {
    "condition": "room-1.temperature-sensor-2.temperature == room-1.temperature-sensor-2-const.maxTemperature",
    "action": {
      "type": "lambda",
      "functionName": "high-temperature-callback",
      "autoDeploy": true,
      "feedback": {
        "type": "mqtt",
        "topic": "dt-temperature-sensor-2",
        "payload": {
          "message": "Temperature too high!"
        }
      }
    }
  },
  {
    "condition": "room-1.temperature-sensor-2.temperature == DOUBLE(40)",
    "action": {
      "type": "lambda",
      "functionName": "high-temperature-callback-2",
      "pathToCode": "lambda_functions/event_actions/high-temperature-callback-2",
      "autoDeploy": true,
      "feedback": {
        "type": "mqtt",
        "iotDeviceId": "temperature-sensor-2",
        "payload": "action-result"
      }
    }
  }
]</code></pre>

        <p class="mt-2"><strong>Notes:</strong></p>
        <ul>
          <li>Conditions use TwinMaker query syntax</li>
          <li>If <code>autoDeploy</code> is true, the Lambda function is automatically deployed</li>
          <li>Feedback can be sent via MQTT to IoT devices</li>
        </ul>
      </div>

    </main>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <button id="backToTop" class="btn btn-primary rounded-circle position-fixed bottom-0 end-0 m-4 shadow fade p-3"
    style="display:none;">
    <i class="fa-solid fa-arrow-up"></i>
  </button>
  <script src="js/docs-nav.js" defer></script>
</body>

</html>